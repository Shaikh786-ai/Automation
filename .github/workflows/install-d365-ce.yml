name: Install Power Platform Application
 
# Trigger the workflow manually or on push to a branch
on:
  workflow_dispatch:
  push:
    branches:
      - main
 
jobs:
  install_app:
    runs-on: ubuntu-latest

    permissions:
      id-token: write
      contents: read
 
    steps:
      # 1️⃣ Checkout the repo
      - name: Checkout repository
        uses: actions/checkout@v3
 
      # 2️⃣ Install Power Platform Tools (CLI)
      - name: Install Power Platform CLI
        uses: microsoft/powerplatform-actions/actions-install@v1.9.1
 
      # 3️⃣ Install the application to Power Platform
      - name: Install application
        uses: microsoft/powerplatform-actions/install-application@v1.9.1
        with:
          # URL of the target environment
          environment-url: ${{ secrets.PP_ENVIRONMENT_URL }}
 
          # Auth via Service Principal (recommended)
          app-id: ${{ secrets.PP_APP_ID }}
          tenant-id: ${{ secrets.PP_TENANT_ID }}

 
          # Path to the app package (msapp, zip, etc.)
          app-package: 'https://github.com/Shaikh786-ai/Automation/blob/My_Automation/MyApps.json'
 
          # Optional: specify whether to overwrite
          overwrite: 'true'
